---
export async function getStaticPaths() {
  const faculties = ["bca", "bit", "csit", "bicte"]
  const paths = []
  for (const faculty of faculties) {
    for (let semester = 1; semester <= 8; semester++) {
      paths.push({ params: { faculty, semester: semester.toString() } })
    }
  }
  return paths
}
import Container from "../../../components/Container.astro"
import Layout from "../../../layouts/Layout.astro"
import NavbarNotes from "../../../components/NavbarNotes.astro"
const { faculty, semester } = Astro.params

const facultyMap: Record<string, string> = {
  bca: "BCA",
  bit: "BIT",
  csit: "CSIT",
  bicte: "BICTE",
}
const facultyName =
  faculty && facultyMap[faculty] ? facultyMap[faculty] : "Unknown Faculty"

// Dynamic import of faculty JSON
let facultyData
try {
  facultyData = await import(`../../../components/Data/notes-${faculty}.json`)
} catch (e) {
  facultyData = null
}
const semesters = facultyData?.default?.semesters || []
const info = facultyData?.default?.facultyInfo
type SemesterType = {
  semester: string | number
  courses?: any[]
  electiveCourses?: any[]
}
const semesterData = semesters.find(
  (s: SemesterType) => String(s.semester) === String(semester)
)
---

<Layout
  title={`${facultyName} Semester ${semester} - Notes & Syllabus`}
  description={`Find detailed notes, syllabus, and past questions for ${facultyName} Semester ${semester} at BOSC.`}
  image="https://bosc.org.np/cover.jpg"
  url={`https://bosc.org.np/notes/${faculty}/${semester}`}
>
  <main class="space-y-12">
    <Container>
      <div class="flex flex-col md:flex-row">
        <NavbarNotes currentFaculty={faculty} currentSemester={semester} />
        <div class="m-6 flex-1">
          <h1 class="text-2xl font-bold mb-4">
            {facultyName} - Semester {semester}
          </h1>
          {
            info?.curricularStructure && (
              <section class="mb-6">
                <div class="bg-purple-50 rounded-lg p-4 text-gray-700 shadow">
                  <strong>Curricular Info:</strong> {info.curricularStructure}
                </div>
              </section>
            )
          }
          {
            semesterData ? (
              <div>
                <table class="min-w-full border mt-4 rounded-lg overflow-hidden shadow">
                  <thead class="bg-purple-100">
                    <tr>
                      {/* <th class="border px-4 py-2">Code</th> */}
                      <th class="border px-4 py-2">Subject</th>
                      <th class="border px-4 py-2">Credits</th>
                      <th class="border px-4 py-2">Notes</th>
                      <th class="border px-4 py-2">Past Qs</th>
                      <th class="border px-4 py-2">Syllabus</th>
                    </tr>
                  </thead>
                  <tbody>
                    {Array.isArray(semesterData.courses) &&
                      semesterData.courses.map((subject: any) => (
                        <tr class="even:bg-purple-50">
                          {/* <td class="border px-2 py-2">
                            {subject.code || "-"}
                          </td> */}
                          <td class="border px-2 py-2">{subject.name}</td>
                          <td class="border px-2 py-2 text-center">
                            {subject.credits}
                          </td>
                          <td class="border px-2 py-2 text-center">
                            {subject.notesLink ? (
                              <a
                                href={subject.notesLink}
                                target="_blank"
                                rel="noopener noreferrer"
                                class="text-purple-700 hover:underline flex items-center gap-1"
                              >
                                Notes{" "}
                                <svg
                                  class="w-4 h-4 inline"
                                  fill="none"
                                  stroke="currentColor"
                                  stroke-width="2"
                                  viewBox="0 0 24 24"
                                >
                                  <path d="M14 3h7v7m0 0L10 21l-7-7" />
                                </svg>
                              </a>
                            ) : (
                              <span class="text-gray-400">Notes</span>
                            )}
                          </td>
                          <td class="border px-2 py-2 text-center">
                            {subject.pastQuestionsLink ? (
                              <a
                                href={subject.pastQuestionsLink}
                                target="_blank"
                                rel="noopener noreferrer"
                                class="text-purple-700 hover:underline flex items-center gap-1"
                              >
                                Past Qs{" "}
                                <svg
                                  class="w-4 h-4 inline"
                                  fill="none"
                                  stroke="currentColor"
                                  stroke-width="2"
                                  viewBox="0 0 24 24"
                                >
                                  <path d="M14 3h7v7m0 0L10 21l-7-7" />
                                </svg>
                              </a>
                            ) : (
                              <span class="text-gray-400">Past Qs</span>
                            )}
                          </td>
                          <td class="border px-2 py-2 text-center">
                            {subject.syllabusLink ? (
                              <a
                                href={subject.syllabusLink}
                                target="_blank"
                                rel="noopener noreferrer"
                                class="text-purple-700 hover:underline flex items-center gap-1"
                              >
                                Syllabus{" "}
                                <svg
                                  class="w-4 h-4 inline"
                                  fill="none"
                                  stroke="currentColor"
                                  stroke-width="2"
                                  viewBox="0 0 24 24"
                                >
                                  <path d="M14 3h7v7m0 0L10 21l-7-7" />
                                </svg>
                              </a>
                            ) : (
                              <span class="text-gray-400">Syllabus</span>
                            )}
                          </td>
                        </tr>
                      ))}
                  </tbody>
                </table>
                {Array.isArray(semesterData.electiveCourses) && (
                  <div class="mt-8">
                    <h2 class="text-lg font-semibold mb-2">Electives</h2>
                    <table class="min-w-full border rounded-lg overflow-hidden shadow">
                      <thead class="bg-purple-100">
                        <tr>
                          {/* <th class="border px-4 py-2">Code</th> */}
                          <th class="border px-4 py-2">Elective Subject</th>
                          <th class="border px-4 py-2">Credits</th>
                          <th class="border px-4 py-2">Notes</th>
                          <th class="border px-4 py-2">Past Qs</th>
                          <th class="border px-4 py-2">Syllabus</th>
                        </tr>
                      </thead>
                      <tbody>
                        {semesterData.electiveCourses.map((elective: any) => (
                          <tr class="even:bg-purple-50">
                            {/* <td class="border px-2 py-2">
                              {elective.code || "-"}
                            </td> */}
                            <td class="border px-2 py-2">{elective.name}</td>
                            <td class="border px-2 py-2 text-center">
                              {elective.credits}
                            </td>
                            <td class="border px-2 py-2 text-center">
                              {elective.notesLink ? (
                                <a
                                  href={elective.notesLink}
                                  target="_blank"
                                  rel="noopener noreferrer"
                                  class="text-purple-700 hover:underline flex items-center gap-1"
                                >
                                  Notes{" "}
                                  <svg
                                    class="w-4 h-4 inline"
                                    fill="none"
                                    stroke="currentColor"
                                    stroke-width="2"
                                    viewBox="0 0 24 24"
                                  >
                                    <path d="M14 3h7v7m0 0L10 21l-7-7" />
                                  </svg>
                                </a>
                              ) : (
                                <span class="text-gray-400">Notes</span>
                              )}
                            </td>
                            <td class="border px-2 py-2 text-center">
                              {elective.pastQuestionsLink ? (
                                <a
                                  href={elective.pastQuestionsLink}
                                  target="_blank"
                                  rel="noopener noreferrer"
                                  class="text-purple-700 hover:underline flex items-center gap-1"
                                >
                                  Past Qs{" "}
                                  <svg
                                    class="w-4 h-4 inline"
                                    fill="none"
                                    stroke="currentColor"
                                    stroke-width="2"
                                    viewBox="0 0 24 24"
                                  >
                                    <path d="M14 3h7v7m0 0L10 21l-7-7" />
                                  </svg>
                                </a>
                              ) : (
                                <span class="text-gray-400">Past Qs</span>
                              )}
                            </td>
                            <td class="border px-2 py-2 text-center">
                              {elective.syllabusLink ? (
                                <a
                                  href={elective.syllabusLink}
                                  target="_blank"
                                  rel="noopener noreferrer"
                                  class="text-purple-700 hover:underline flex items-center gap-1"
                                >
                                  Syllabus{" "}
                                  <svg
                                    class="w-4 h-4 inline"
                                    fill="none"
                                    stroke="currentColor"
                                    stroke-width="2"
                                    viewBox="0 0 24 24"
                                  >
                                    <path d="M14 3h7v7m0 0L10 21l-7-7" />
                                  </svg>
                                </a>
                              ) : (
                                <span class="text-gray-400">Syllabus</span>
                              )}
                            </td>
                          </tr>
                        ))}
                      </tbody>
                    </table>
                  </div>
                )}
              </div>
            ) : (
              <p class="text-gray-600">
                No course data available for Semester {semester} of{" "}
                {facultyName}.
              </p>
            )
          }
        </div>
      </div>
    </Container>
  </main>
</Layout>
