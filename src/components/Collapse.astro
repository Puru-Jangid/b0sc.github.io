---
const { label, index = null } = Astro.props
---

<div class="outline-none accordion-section" tabindex="1">
  <div
    class="accordion-header h-[170px] shadow-card bg-zinc-100 rounded-3xl flex justify-between px-4 py-3 items-center transition-colors ease duration-500 cursor-pointer pr-10 relative"
  >
    <div class="flex items-center px-10 pt-10 w-full transition ease duration-500">
      <div class="flex pb-10 gap-5 w-full items-center">
        <div class="flex justify-between w-full items-center rounded-full">
          <div class="flex items-center gap-5">
            {index && (
              <>
                <p class="text-5xl font-medium flex items-center">{index}</p>
                <p class="text-xl px-4 overflow-hidden text-ellipsis line-clamp-2 transition-all duration-500">
                  {label}
                </p>
              </>
            )}
          </div>
          <div
            class="rounded-full after:h-[2px] relative accodion-chevron border-black md:border-2 flex md:items-center md:bg-zinc-100 h-10 w-10 px-4"
          ></div>
        </div>
      </div>
    </div>
  </div>
  <div
    class="accordion-content max-h-0 shadow-card rounded-b-3xl bg-zinc-100 px-4 overflow-hidden transition-all ease duration-500"
  >
    <p class="text-justify text-black p-10">
      <slot />
    </p>
  </div>
</div>

<style>
  /* Chevron style for the plus sign (+) */
  .accodion-chevron::after {
    content: "";
    @apply h-[53%] w-[8px] transform transition-transform duration-500 bg-black absolute left-1/2 -translate-x-1/2;
  }
  .accodion-chevron::before {
    content: "";
    @apply h-[53%] w-[8px] rotate-90 transform transition-transform duration-500 bg-black absolute left-1/2 -translate-x-1/2;
  }

  /* Clamping text to 2 lines initially */
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 2;
    overflow: hidden;
  }

  /* Toggle open class */
  .accordion-section.open .accordion-content {
    max-height: 1000px; /* enough to show full content */
    @apply bg-lime-500;
  }

  .accordion-section.open .line-clamp-2 {
    -webkit-line-clamp: unset;
  }

  .accordion-section.open .accodion-chevron::after {
    @apply rotate-90;
  }

  .accordion-section.open .accordion-header {
    @apply bg-lime-500  rounded-b-none rounded-t-3xl;
  }
</style>

<script>
  const sections = document.querySelectorAll(".accordion-section");

  sections.forEach((section) => {
    const header = section.querySelector(".accordion-header");
    if (!header) return; // fix null warning

    header.addEventListener("click", () => {
      // Close all other sections
      sections.forEach((s) => {
        if (s !== section) {
          s.classList.remove("open");
        }
      });

      // Toggle this section
      section.classList.toggle("open");
    });
  });
</script>
